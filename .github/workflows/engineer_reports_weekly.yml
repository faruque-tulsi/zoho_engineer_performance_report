name: Weekly Engineer Performance Reports

on:
  schedule:
    # Every Saturday at 6:00 PM IST (12:30 UTC)
    - cron: '30 12 * * 6'
  workflow_dispatch: # Allows manual triggering

jobs:
  # ========== BATCH 1 (5 engineers) ==========
  AnimeshKundu:
    runs-on: ubuntu-latest
    continue-on-error: true
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-python@v5
        with:
          python-version: '3.10'
      - run: pip install -r requirements.txt
      - run: python AnimeshKundu.py
        env:
          ZOHO_CLIENT_ID: ${{ secrets.ZOHO_CLIENT_ID }}
          ZOHO_CLIENT_SECRET: ${{ secrets.ZOHO_CLIENT_SECRET }}
          ZOHO_REFRESH_TOKEN: ${{ secrets.ZOHO_REFRESH_TOKEN }}
          WA_TOKEN: ${{ secrets.WA_TOKEN }}

  Asim_Dey:
    runs-on: ubuntu-latest
    continue-on-error: true
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-python@v5
        with:
          python-version: '3.10'
      - run: pip install -r requirements.txt
      - run: python Asim_Dey.py
        env:
          ZOHO_CLIENT_ID: ${{ secrets.ZOHO_CLIENT_ID }}
          ZOHO_CLIENT_SECRET: ${{ secrets.ZOHO_CLIENT_SECRET }}
          ZOHO_REFRESH_TOKEN: ${{ secrets.ZOHO_REFRESH_TOKEN }}
          WA_TOKEN: ${{ secrets.WA_TOKEN }}

  Dipu_Mandal:
    runs-on: ubuntu-latest
    continue-on-error: true
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-python@v5
        with:
          python-version: '3.10'
      - run: pip install -r requirements.txt
      - run: python Dipu_Mandal.py
        env:
          ZOHO_CLIENT_ID: ${{ secrets.ZOHO_CLIENT_ID }}
          ZOHO_CLIENT_SECRET: ${{ secrets.ZOHO_CLIENT_SECRET }}
          ZOHO_REFRESH_TOKEN: ${{ secrets.ZOHO_REFRESH_TOKEN }}
          WA_TOKEN: ${{ secrets.WA_TOKEN }}

  Hiranmay_Maji:
    runs-on: ubuntu-latest
    continue-on-error: true
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-python@v5
        with:
          python-version: '3.10'
      - run: pip install -r requirements.txt
      - run: python Hiranmay_Maji.py
        env:
          ZOHO_CLIENT_ID: ${{ secrets.ZOHO_CLIENT_ID }}
          ZOHO_CLIENT_SECRET: ${{ secrets.ZOHO_CLIENT_SECRET }}
          ZOHO_REFRESH_TOKEN: ${{ secrets.ZOHO_REFRESH_TOKEN }}
          WA_TOKEN: ${{ secrets.WA_TOKEN }}

  Indrajit_Das:
    runs-on: ubuntu-latest
    continue-on-error: true
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-python@v5
        with:
          python-version: '3.10'
      - run: pip install -r requirements.txt
      - run: python Indrajit_Das.py
        env:
          ZOHO_CLIENT_ID: ${{ secrets.ZOHO_CLIENT_ID }}
          ZOHO_CLIENT_SECRET: ${{ secrets.ZOHO_CLIENT_SECRET }}
          ZOHO_REFRESH_TOKEN: ${{ secrets.ZOHO_REFRESH_TOKEN }}
          WA_TOKEN: ${{ secrets.WA_TOKEN }}

  # ========== BATCH 2 (5 engineers) - Runs even if Batch 1 has failures ==========
  Kousik_Paul:
    runs-on: ubuntu-latest
    continue-on-error: true
    needs: [AnimeshKundu, Asim_Dey, Dipu_Mandal, Hiranmay_Maji, Indrajit_Das]
    if: always()  # Run even if previous batch has failures
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-python@v5
        with:
          python-version: '3.10'
      - run: pip install -r requirements.txt
      - run: python Kousik_Paul.py
        env:
          ZOHO_CLIENT_ID: ${{ secrets.ZOHO_CLIENT_ID }}
          ZOHO_CLIENT_SECRET: ${{ secrets.ZOHO_CLIENT_SECRET }}
          ZOHO_REFRESH_TOKEN: ${{ secrets.ZOHO_REFRESH_TOKEN }}
          WA_TOKEN: ${{ secrets.WA_TOKEN }}

  Naibendu_Dutta:
    runs-on: ubuntu-latest
    continue-on-error: true
    needs: [AnimeshKundu, Asim_Dey, Dipu_Mandal, Hiranmay_Maji, Indrajit_Das]
    if: always()
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-python@v5
        with:
          python-version: '3.10'
      - run: pip install -r requirements.txt
      - run: python Naibendu_Dutta.py
        env:
          ZOHO_CLIENT_ID: ${{ secrets.ZOHO_CLIENT_ID }}
          ZOHO_CLIENT_SECRET: ${{ secrets.ZOHO_CLIENT_SECRET }}
          ZOHO_REFRESH_TOKEN: ${{ secrets.ZOHO_REFRESH_TOKEN }}
          WA_TOKEN: ${{ secrets.WA_TOKEN }}

  Nitai_Barman:
    runs-on: ubuntu-latest
    continue-on-error: true
    needs: [AnimeshKundu, Asim_Dey, Dipu_Mandal, Hiranmay_Maji, Indrajit_Das]
    if: always()
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-python@v5
        with:
          python-version: '3.10'
      - run: pip install -r requirements.txt
      - run: python Nitai_Barman.py
        env:
          ZOHO_CLIENT_ID: ${{ secrets.ZOHO_CLIENT_ID }}
          ZOHO_CLIENT_SECRET: ${{ secrets.ZOHO_CLIENT_SECRET }}
          ZOHO_REFRESH_TOKEN: ${{ secrets.ZOHO_REFRESH_TOKEN }}
          WA_TOKEN: ${{ secrets.WA_TOKEN }}

  Prabir_Sardar:
    runs-on: ubuntu-latest
    continue-on-error: true
    needs: [AnimeshKundu, Asim_Dey, Dipu_Mandal, Hiranmay_Maji, Indrajit_Das]
    if: always()
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-python@v5
        with:
          python-version: '3.10'
      - run: pip install -r requirements.txt
      - run: python Prabir_Sardar.py
        env:
          ZOHO_CLIENT_ID: ${{ secrets.ZOHO_CLIENT_ID }}
          ZOHO_CLIENT_SECRET: ${{ secrets.ZOHO_CLIENT_SECRET }}
          ZOHO_REFRESH_TOKEN: ${{ secrets.ZOHO_REFRESH_TOKEN }}
          WA_TOKEN: ${{ secrets.WA_TOKEN }}

  SK_Habibul:
    runs-on: ubuntu-latest
    continue-on-error: true
    needs: [AnimeshKundu, Asim_Dey, Dipu_Mandal, Hiranmay_Maji, Indrajit_Das]
    if: always()
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-python@v5
        with:
          python-version: '3.10'
      - run: pip install -r requirements.txt
      - run: python SK_Habibul.py
        env:
          ZOHO_CLIENT_ID: ${{ secrets.ZOHO_CLIENT_ID }}
          ZOHO_CLIENT_SECRET: ${{ secrets.ZOHO_CLIENT_SECRET }}
          ZOHO_REFRESH_TOKEN: ${{ secrets.ZOHO_REFRESH_TOKEN }}
          WA_TOKEN: ${{ secrets.WA_TOKEN }}

  # ========== BATCH 3 (5 engineers) - Runs even if Batch 2 has failures ==========
  Saikat_Mukherjee:
    runs-on: ubuntu-latest
    continue-on-error: true
    needs: [Kousik_Paul, Naibendu_Dutta, Nitai_Barman, Prabir_Sardar, SK_Habibul]
    if: always()
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-python@v5
        with:
          python-version: '3.10'
      - run: pip install -r requirements.txt
      - run: python Saikat_Mukherjee.py
        env:
          ZOHO_CLIENT_ID: ${{ secrets.ZOHO_CLIENT_ID }}
          ZOHO_CLIENT_SECRET: ${{ secrets.ZOHO_CLIENT_SECRET }}
          ZOHO_REFRESH_TOKEN: ${{ secrets.ZOHO_REFRESH_TOKEN }}
          WA_TOKEN: ${{ secrets.WA_TOKEN }}

  Sajal_Poria:
    runs-on: ubuntu-latest
    continue-on-error: true
    needs: [Kousik_Paul, Naibendu_Dutta, Nitai_Barman, Prabir_Sardar, SK_Habibul]
    if: always()
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-python@v5
        with:
          python-version: '3.10'
      - run: pip install -r requirements.txt
      - run: python Sajal_Poria.py
        env:
          ZOHO_CLIENT_ID: ${{ secrets.ZOHO_CLIENT_ID }}
          ZOHO_CLIENT_SECRET: ${{ secrets.ZOHO_CLIENT_SECRET }}
          ZOHO_REFRESH_TOKEN: ${{ secrets.ZOHO_REFRESH_TOKEN }}
          WA_TOKEN: ${{ secrets.WA_TOKEN }}

  Saptarshi_Ghosh:
    runs-on: ubuntu-latest
    continue-on-error: true
    needs: [Kousik_Paul, Naibendu_Dutta, Nitai_Barman, Prabir_Sardar, SK_Habibul]
    if: always()
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-python@v5
        with:
          python-version: '3.10'
      - run: pip install -r requirements.txt
      - run: python Saptarshi_Ghosh.py
        env:
          ZOHO_CLIENT_ID: ${{ secrets.ZOHO_CLIENT_ID }}
          ZOHO_CLIENT_SECRET: ${{ secrets.ZOHO_CLIENT_SECRET }}
          ZOHO_REFRESH_TOKEN: ${{ secrets.ZOHO_REFRESH_TOKEN }}
          WA_TOKEN: ${{ secrets.WA_TOKEN }}

  Sayan_Adhikary:
    runs-on: ubuntu-latest
    continue-on-error: true
    needs: [Kousik_Paul, Naibendu_Dutta, Nitai_Barman, Prabir_Sardar, SK_Habibul]
    if: always()
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-python@v5
        with:
          python-version: '3.10'
      - run: pip install -r requirements.txt
      - run: python Sayan_Adhikary.py
        env:
          ZOHO_CLIENT_ID: ${{ secrets.ZOHO_CLIENT_ID }}
          ZOHO_CLIENT_SECRET: ${{ secrets.ZOHO_CLIENT_SECRET }}
          ZOHO_REFRESH_TOKEN: ${{ secrets.ZOHO_REFRESH_TOKEN }}
          WA_TOKEN: ${{ secrets.WA_TOKEN }}

  Shasanka_Sardar:
    runs-on: ubuntu-latest
    continue-on-error: true
    needs: [Kousik_Paul, Naibendu_Dutta, Nitai_Barman, Prabir_Sardar, SK_Habibul]
    if: always()
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-python@v5
        with:
          python-version: '3.10'
      - run: pip install -r requirements.txt
      - run: python Shasanka_Sardar.py
        env:
          ZOHO_CLIENT_ID: ${{ secrets.ZOHO_CLIENT_ID }}
          ZOHO_CLIENT_SECRET: ${{ secrets.ZOHO_CLIENT_SECRET }}
          ZOHO_REFRESH_TOKEN: ${{ secrets.ZOHO_REFRESH_TOKEN }}
          WA_TOKEN: ${{ secrets.WA_TOKEN }}

  # ========== BATCH 4 (5 engineers) - Runs even if Batch 3 has failures ==========
  Shibnath_Chatterjee:
    runs-on: ubuntu-latest
    continue-on-error: true
    needs: [Saikat_Mukherjee, Sajal_Poria, Saptarshi_Ghosh, Sayan_Adhikary, Shasanka_Sardar]
    if: always()
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-python@v5
        with:
          python-version: '3.10'
      - run: pip install -r requirements.txt
      - run: python Shibnath_Chatterjee.py
        env:
          ZOHO_CLIENT_ID: ${{ secrets.ZOHO_CLIENT_ID }}
          ZOHO_CLIENT_SECRET: ${{ secrets.ZOHO_CLIENT_SECRET }}
          ZOHO_REFRESH_TOKEN: ${{ secrets.ZOHO_REFRESH_TOKEN }}
          WA_TOKEN: ${{ secrets.WA_TOKEN }}

  Somnath_Adak:
    runs-on: ubuntu-latest
    continue-on-error: true
    needs: [Saikat_Mukherjee, Sajal_Poria, Saptarshi_Ghosh, Sayan_Adhikary, Shasanka_Sardar]
    if: always()
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-python@v5
        with:
          python-version: '3.10'
      - run: pip install -r requirements.txt
      - run: python Somnath_Adak.py
        env:
          ZOHO_CLIENT_ID: ${{ secrets.ZOHO_CLIENT_ID }}
          ZOHO_CLIENT_SECRET: ${{ secrets.ZOHO_CLIENT_SECRET }}
          ZOHO_REFRESH_TOKEN: ${{ secrets.ZOHO_REFRESH_TOKEN }}
          WA_TOKEN: ${{ secrets.WA_TOKEN }}

  Subash_Banik:
    runs-on: ubuntu-latest
    continue-on-error: true
    needs: [Saikat_Mukherjee, Sajal_Poria, Saptarshi_Ghosh, Sayan_Adhikary, Shasanka_Sardar]
    if: always()
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-python@v5
        with:
          python-version: '3.10'
      - run: pip install -r requirements.txt
      - run: python Subash_Banik.py
        env:
          ZOHO_CLIENT_ID: ${{ secrets.ZOHO_CLIENT_ID }}
          ZOHO_CLIENT_SECRET: ${{ secrets.ZOHO_CLIENT_SECRET }}
          ZOHO_REFRESH_TOKEN: ${{ secrets.ZOHO_REFRESH_TOKEN }}
          WA_TOKEN: ${{ secrets.WA_TOKEN }}

  Subhadep_Halder:
    runs-on: ubuntu-latest
    continue-on-error: true
    needs: [Saikat_Mukherjee, Sajal_Poria, Saptarshi_Ghosh, Sayan_Adhikary, Shasanka_Sardar]
    if: always()
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-python@v5
        with:
          python-version: '3.10'
      - run: pip install -r requirements.txt
      - run: python Subhadep_Halder.py
        env:
          ZOHO_CLIENT_ID: ${{ secrets.ZOHO_CLIENT_ID }}
          ZOHO_CLIENT_SECRET: ${{ secrets.ZOHO_CLIENT_SECRET }}
          ZOHO_REFRESH_TOKEN: ${{ secrets.ZOHO_REFRESH_TOKEN }}
          WA_TOKEN: ${{ secrets.WA_TOKEN }}

  Subhajit_Jana:
    runs-on: ubuntu-latest
    continue-on-error: true
    needs: [Saikat_Mukherjee, Sajal_Poria, Saptarshi_Ghosh, Sayan_Adhikary, Shasanka_Sardar]
    if: always()
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-python@v5
        with:
          python-version: '3.10'
      - run: pip install -r requirements.txt
      - run: python Subhajit_Jana.py
        env:
          ZOHO_CLIENT_ID: ${{ secrets.ZOHO_CLIENT_ID }}
          ZOHO_CLIENT_SECRET: ${{ secrets.ZOHO_CLIENT_SECRET }}
          ZOHO_REFRESH_TOKEN: ${{ secrets.ZOHO_REFRESH_TOKEN }}
          WA_TOKEN: ${{ secrets.WA_TOKEN }}

  # ========== BATCH 5 (6 engineers + main) - Runs even if Batch 4 has failures ==========
  Sujit_Kumar_Poodar:
    runs-on: ubuntu-latest
    continue-on-error: true
    needs: [Shibnath_Chatterjee, Somnath_Adak, Subash_Banik, Subhadep_Halder, Subhajit_Jana]
    if: always()
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-python@v5
        with:
          python-version: '3.10'
      - run: pip install -r requirements.txt
      - run: python Sujit_Kumar_Poodar.py
        env:
          ZOHO_CLIENT_ID: ${{ secrets.ZOHO_CLIENT_ID }}
          ZOHO_CLIENT_SECRET: ${{ secrets.ZOHO_CLIENT_SECRET }}
          ZOHO_REFRESH_TOKEN: ${{ secrets.ZOHO_REFRESH_TOKEN }}
          WA_TOKEN: ${{ secrets.WA_TOKEN }}

  Suman_Roy:
    runs-on: ubuntu-latest
    continue-on-error: true
    needs: [Shibnath_Chatterjee, Somnath_Adak, Subash_Banik, Subhadep_Halder, Subhajit_Jana]
    if: always()
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-python@v5
        with:
          python-version: '3.10'
      - run: pip install -r requirements.txt
      - run: python Suman_Roy.py
        env:
          ZOHO_CLIENT_ID: ${{ secrets.ZOHO_CLIENT_ID }}
          ZOHO_CLIENT_SECRET: ${{ secrets.ZOHO_CLIENT_SECRET }}
          ZOHO_REFRESH_TOKEN: ${{ secrets.ZOHO_REFRESH_TOKEN }}
          WA_TOKEN: ${{ secrets.WA_TOKEN }}

  Swarup_Das:
    runs-on: ubuntu-latest
    continue-on-error: true
    needs: [Shibnath_Chatterjee, Somnath_Adak, Subash_Banik, Subhadep_Halder, Subhajit_Jana]
    if: always()
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-python@v5
        with:
          python-version: '3.10'
      - run: pip install -r requirements.txt
      - run: python Swarup_Das.py
        env:
          ZOHO_CLIENT_ID: ${{ secrets.ZOHO_CLIENT_ID }}
          ZOHO_CLIENT_SECRET: ${{ secrets.ZOHO_CLIENT_SECRET }}
          ZOHO_REFRESH_TOKEN: ${{ secrets.ZOHO_REFRESH_TOKEN }}
          WA_TOKEN: ${{ secrets.WA_TOKEN }}

  Tanmay_Mondal:
    runs-on: ubuntu-latest
    continue-on-error: true
    needs: [Shibnath_Chatterjee, Somnath_Adak, Subash_Banik, Subhadep_Halder, Subhajit_Jana]
    if: always()
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-python@v5
        with:
          python-version: '3.10'
      - run: pip install -r requirements.txt
      - run: python Tanmay_Mondal.py
        env:
          ZOHO_CLIENT_ID: ${{ secrets.ZOHO_CLIENT_ID }}
          ZOHO_CLIENT_SECRET: ${{ secrets.ZOHO_CLIENT_SECRET }}
          ZOHO_REFRESH_TOKEN: ${{ secrets.ZOHO_REFRESH_TOKEN }}
          WA_TOKEN: ${{ secrets.WA_TOKEN }}

  Tapas_Majhi:
    runs-on: ubuntu-latest
    continue-on-error: true
    needs: [Shibnath_Chatterjee, Somnath_Adak, Subash_Banik, Subhadep_Halder, Subhajit_Jana]
    if: always()
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-python@v5
        with:
          python-version: '3.10'
      - run: pip install -r requirements.txt
      - run: python Tapas_Majhi.py
        env:
          ZOHO_CLIENT_ID: ${{ secrets.ZOHO_CLIENT_ID }}
          ZOHO_CLIENT_SECRET: ${{ secrets.ZOHO_CLIENT_SECRET }}
          ZOHO_REFRESH_TOKEN: ${{ secrets.ZOHO_REFRESH_TOKEN }}
          WA_TOKEN: ${{ secrets.WA_TOKEN }}

  Main_Report:
    runs-on: ubuntu-latest
    continue-on-error: true
    needs: [Shibnath_Chatterjee, Somnath_Adak, Subash_Banik, Subhadep_Halder, Subhajit_Jana]
    if: always()
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-python@v5
        with:
          python-version: '3.10'
      - run: pip install -r requirements.txt
      - run: python zoho_analytics_export.py
        env:
          ZOHO_CLIENT_ID: ${{ secrets.ZOHO_CLIENT_ID }}
          ZOHO_CLIENT_SECRET: ${{ secrets.ZOHO_CLIENT_SECRET }}
          ZOHO_REFRESH_TOKEN: ${{ secrets.ZOHO_REFRESH_TOKEN }}
          WA_TOKEN: ${{ secrets.WA_TOKEN }}
